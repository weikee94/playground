---
title: 微前端架构入门
tags: 微前端, 架构, Module Federation
date: 2026-01-30
---

# 微前端架构入门

微前端是一种将前端应用分解为更小、更简单的独立应用的架构风格。

## 🎯 为什么需要微前端?

### 问题场景

当你的前端应用越来越大时,会遇到这些问题:
- **构建时间长**: 修改一个小功能需要等待整个应用构建
- **团队协作难**: 多个团队修改同一个代码库容易冲突
- **技术栈锁定**: 无法尝试新技术,必须统一技术栈
- **部署风险高**: 一个模块的 bug 可能影响整个应用

### 微前端的解决方案

将大型应用拆分成多个独立的微应用:
- 每个微应用独立开发、测试、部署
- 可以使用不同的技术栈(React, Vue, Angular)
- 运行时动态加载,按需加载模块
- 独立团队负责各自的微应用

## 🧪 主流方案对比

### 1. qiankun (阿里开源)

**优点:**
- 基于 single-spa,成熟稳定
- 开箱即用,配置简单
- 沙箱隔离(JS、CSS)
- 中文文档完善

**缺点:**
- 运行时加载,性能开销
- 主应用和微应用强耦合

**适用场景:** 中后台系统、管理后台

### 2. Module Federation (Webpack 5)

**优点:**
- Webpack 原生支持,无需额外框架
- 构建时优化,性能更好
- 支持共享依赖(React、Vue 只加载一次)
- 真正的独立部署

**缺点:**
- 配置复杂,学习曲线陡
- 需要 Webpack 5+
- 调试困难

**适用场景:** 大型企业应用、多团队协作

### 3. Micro-App (京东开源)

**优点:**
- 类 Web Component 使用体验
- 零依赖,体积小
- 自动隔离样式和 JS

**缺点:**
- 社区较小
- 功能相对简单

**适用场景:** 中小型项目快速落地

## 💡 实现要点

### 路由管理

微前端最核心的是路由分发:

```javascript
// 主应用路由配置
const routes = [
  { path: '/app1/*', app: 'micro-app-1' },
  { path: '/app2/*', app: 'micro-app-2' },
]
```

### 通信方案

微应用之间需要通信:
- **Props 传递**: 主应用传递数据给微应用
- **事件总线**: 自定义事件系统
- **全局状态**: Redux、Pinia 等状态管理

### 样式隔离

避免样式冲突:
- CSS Modules
- Shadow DOM
- CSS-in-JS
- 命名空间(BEM)

## 🔥 踩坑记录

### 1. 公共依赖重复加载

**问题:** React 被加载了 3 次,包体积过大

**解决:** 使用 externals 或 Module Federation 的 shared 配置

### 2. 路由冲突

**问题:** 微应用的路由和主应用冲突

**解决:** 给每个微应用加路由前缀,如 `/app1/home`

### 3. 全局变量污染

**问题:** 微应用修改了 window 对象,影响其他应用

**解决:** 使用沙箱隔离,或严格的代码规范

## 🚀 下一步学习路径

1. **理论学习**: 阅读 single-spa、qiankun 文档
2. **动手实践**: 搭建一个简单的 qiankun demo
3. **深入探索**: 学习 Module Federation 原理
4. **生产实践**: 在实际项目中落地微前端

## 参考资料

- [qiankun 官方文档](https://qiankun.umijs.org/)
- [Module Federation 示例](https://module-federation.github.io/)
- [Micro Frontends 最佳实践](https://micro-frontends.org/)
